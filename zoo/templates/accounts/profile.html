{% extends base %}

{% load favourites_extras %}

{% block title %}{{ profile.user|title }}{% endblock %}

{% block primary_content %}

<h1>{{ profile.user|title }}{% if profile.user.get_full_name %} ({{ profile.user.get_full_name }}){% endif %}</h1>
{% if profile.badges.all %}
<ul>{{ profile.badges.all|unordered_list }}</ul>
{% endif %}

{% ifequal profile.user user %}
<p><a href="{% url accounts-profile-edit profile.user %}">Edit your profile</a> |
{% if profile.location %}
Your location, not publicly viewable, is currently {{ profile.location }}.
<a href="/edit-location/">Edit your location</a>
{% else %}
<a href="/edit-location/">Set your location</a> to find animals near you
{% endif %}
</p>
{% endifequal %}

<div>
{% if profile.url %}
<p class="url"><a href="{{ profile.url }}">&raquo; {% ifequal profile.user user %}Your website{% else %}Visit their website{% endifequal %}</a></p>
{% endif %}

{% if profile.biography %}
{{ profile.biography|linebreaks}}
{% else %}
{% ifequal profile.user user %}
<p>You don&rsquo;t seem to have filled in your biography yet, so why not <a href='{% url accounts-profile-edit profile.user %}'>do that now</a> and tell us a bit about yourself?</p>
{% else %}
<p>This user has not written a biography yet.</p>
{% endifequal %}
{% endif %}
</div>

<div>
	<h2>{% ifequal profile.user user %}My{% else %}{{ profile.user|title }}&rsquo;s{% endifequal %} Most Recent Trips</h2>
	{% ifequal profile.user user %}<p>Add a trip by <a href="{% url search %}" title="Look for something">finding a place you've spotted animals</a> <em>(hint: try searching for 'London Zoo')</em>, and then on its page tell us the animals you saw.</p>{% endifequal %}
	{% if profile.user.created_trip_set.all %}
	<ol>
	{% for trip in profile.user.created_trip_set.all|slice:":5" %}
		<li><a href="{% url trip-view profile.user, trip.id %}">{{ trip.title }}</a> ({{ trip.species.count }} sighting{{ trip.species.count|pluralize }})</li>
	{% endfor %}
	</ol>
	<p><a href="{% url tripbook profile.user %}">Show all {% ifequal profile.user user %}your{% else %}their{% endifequal %} trips</a>.</p>

	{% else %}
	<p>
		{% ifequal profile.user user %}You haven&rsquo;t{% else %}This user hasn&rsquo;t{% endifequal %} been anywhere yet.
		{% ifequal profile.user user %}View recommendations from other users?{% else %}Recommend somewhere for this user to visit?{% endifequal %}
	</p>
	{% endif %}
</div>

<div>
	<h2>Animal Passport</h2>
	<p>The Animal Passport contains all of the animals you have said you have spotted on a trip to a place.
	{% ifequal profile.user user %}Add more by <a href="{% url search %}" title="Look for something">finding a place you've spotted animals</a>, and then on its page tell us the animals you saw.{% endifequal %}
        </p>
	{% if profile.passport.seen_species %}
	<ol class='animal-passport'>
	{% for species in profile.passport.seen_species %}
		<li>{{ species.count }}&times; <a href="{{ species.urls.absolute }}">{{ species }}</a></li>
	{% endfor %}
	</ol>
	<p>If you've told us that an animal lives at a place &mdash; say because you've checked their website or read a news story about it &mdash; but haven't actually been there, it won&rsquo;t appear in your passport.</p>
	{% else %}
	<p>
		{% ifequal profile.user user %}You apparently haven&rsquo;t{% else %}This user hasn&rsquo;t{% endifequal %} spotted any animals yet.
	</p>
	{% endif %}
</div>

{% endblock %}

{% block secondary_content %}

<div>
        <p>{{ profile.avatar_img }}</p>
</div>

<div>
	<h2>Favourite Animals</h2>
	{% if profile.user.favourite_species.all %}
	<ol>
    {% for favourite in profile.user.favourite_species.all %}
	<li><a href="{{ favourite.species.urls.absolute }}">{{ favourite.species }}</a>
		{% favourite_toggler "remove" favourite.species.slug request.path "link" "" "Remove" %}
	</li>
	{% endfor %}
	</ol>
	{% else %}
	<p>
		{% ifequal profile.user user %}You don&rsquo;t{% else %}This user doesn&rsquo;t{% endifequal %} have any favourite animals yet.
		{% ifequal profile.user user %}Pick some?{% else %}Suggest some?{% endifequal %}
	</p>
	{% endif %}
</div>

<div>
        <h2>Photos</h2>

        {% for photo in profile.user.photos.all %}
                <a href="{{ photo.urls.absolute }}" title="{{ photo.title }}">{{ photo.photo.thumbnail_tag }}</a>
        {% endfor %}
        {% ifequal profile.user user %}<p><a href="{% url upload-photos %}">Upload a photo!</a></p>{% endifequal %}
</div>

{% if profile.user.comment_comments.all %}
        <div>
                <h2>{% ifequal profile.user user %}My{% else %}{{ profile.user|title }}&rsquo;s{% endifequal %} Comments</h2>
                {% for comment in profile.user.comment_comments.all %}
                        <div class="comment">
                                {{ comment.comment|linebreaks }}
                                <div class="posted-by">Posted on <a href="{{ comment.content_object.urls.absolute }}#c{{ comment.id }}">{{ comment.content_object }}</a> at {{ comment.submit_date|date:"jS F Y H:i" }}</div>
                        </div>
                {% endfor %}
        </div>
{% endif %}

{% endblock %}
