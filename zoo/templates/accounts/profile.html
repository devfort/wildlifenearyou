{% extends base %}

{% load favourites_extras %}

{% block title %}{{ profile.user|title }}{% endblock %}

{% block content %}

<h1>{{ profile.user|title }}{% if profile.user.get_full_name %} ({{ profile.user.get_full_name }}){% endif %}</h1>
{% if profile.badges.all %}
<ul>{{ profile.badges.all|unordered_list }}</ul>
{% endif %}

{% ifequal profile.user user %}<p><a href="{% url accounts-profile-edit profile.user %}">Edit your profile</a></p>{% endifequal %}

<div id="bio">
<h2>Biography</h2>
{% if profile.url %}
<p class="url"><a href="{{ profile.url }}">&raquo; {% ifequal profile.user user %}Your website{% else %}Visit their website{% endifequal %}</a></p>
{% endif %}
{% if profile.biography %}
{{ profile.biography|linebreaks}}
{% else %}
<p>You don't seem to have filled in your Bio yet, why not do that now and tell us a bit about yourself?</p>
{% endif  %}
</div>

{% for photo in profile.user.photos.all %}
<a href="{{ photo.urls.absolute }}" title="{{ photo.title }}">{{ photo.photo.thumbnail_tag }}</a>
{% endfor %}
{% ifequal profile.user user %}<p><a href="{% url upload-photos %}">Upload a photo!</a></p>{% endifequal %}

<div id="animal_passport">
	<h2>Animal Passport</h2>
	{% if profile.passport.seen_species %}
	<ol>
	{% for species in profile.passport.seen_species %}
		<li>{{ species.count }}&times; <a href="{{ species.urls.absolute }}">{{ species }}</a></li>
	{% endfor %}
	</ol>
	{% else %}
	<p>
		{% ifequal profile.user user %}You apparently haven't{% else %}This user hasn't{% endifequal %} spotted any animals yet.
		{% ifequal profile.user user %}Spot now?{% endifequal %}
	</p>
	{% endif %}
</div>

<div id="my_trips">
	<h2>{% ifequal profile.user user %}My{% else %}{{ profile.user|title }}'s{% endifequal %} Most Recent Trips</h2>
	{% if profile.user.created_trip_set.all %}
	<ol>
	{% for trip in profile.user.created_trip_set.all|slice:":5" %}
		<li><a href="{% url trip-view profile.user, trip.id %}">{{ trip.title }}</a> ({{ trip.species.count }} sighting{{ trip.species.count|pluralize }})</li>
	{% endfor %}
	</ol>
	<p><a href="{% url tripbook profile.user %}">More...</a></p>
	
	{% else %}
	<p>
		{% ifequal profile.user user %}You haven't{% else %}This user hasn't{% endifequal %} been anywhere yet.
		{% ifequal profile.user user %}View recommendations from other users?{% else %}Recommend somewhere for this user to visit?{% endifequal %}
	</p>
	{% endif %}
</div>

<div id="favourite_species">
	<h2>Favourite Animals</h2>
	{% if profile.user.favourite_species.all %}
	<ol>
    {% for favourite in profile.user.favourite_species.all %}
	<li><a href="{{ favourite.species.urls.absolute }}">{{ favourite.species }}</a>
		{% favourite_toggler "remove" favourite.species.slug request.path  %}
	</li>
	{% endfor %}
	</ol>
	{% else %}
	<p>
		{% ifequal profile.user user %}You don't{% else %}This user doesn't{% endifequal %} have any favourite animals yet.
		{% ifequal profile.user user %}Pick some?{% else %}Suggest some?{% endifequal %}
	</p>
	{% endif %}
</div>


{% if profile.user.comment_comments.all %}
<h2>{% ifequal profile.user user %}My{% else %}{{ profile.user|title }}'s{% endifequal %} Comments:</h2>
{% for comment in profile.user.comment_comments.all %}
<div class="comment">
{{ comment.comment|linebreaks }}
<div class="posted-by">Posted on <a href="{{ comment.content_object.urls.absolute }}#c{{ comment.id }}">{{ comment.content_object }}</a> at {{ comment.submit_date|date:"jS F Y H:i" }}</div>
</div>
{% endfor %}
{% endif %}


{% endblock %}
