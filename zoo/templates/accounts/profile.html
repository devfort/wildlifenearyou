{% extends "base.html" %}

{% load favourites_extras %}

{% block title %}{{ profile.user|title }}{% endblock %}

{% block content %}

<h1>{{ profile.user|title }}</h1>

{% for photo in profile.user.photos.all %}
<a href="{{ photo.urls.absolute }}" title="{{ photo.title }}">{{ photo.photo.thumbnail_tag }}</a>
{% endfor %}
{% ifequal profile.user user %}<p><a href="{% url upload-photos %}">Upload a photo!</a></p>{% endifequal %}
<p>
{% ifequal profile.user user %}
	<a href="{% url logbook-default %}">My Logbook</a>
{% else %}
	<a href="{% url logbook profile.user %}">{{ profile.user|title }}'s Logbook</a>
{% endifequal %}
</p>

<div id="animal_passport">
	<h2>Animal Passport</h2>
	{% if profile.passport.seen_species %}
	<ol>
	{% for species in profile.passport.seen_species %}
		<li>{{ species.count }}&times; <a href="{{ species.urls.absolute }}">{{ species }}</a></li>
	{% endfor %}
	</ol>
	{% else %}
	<p>
		{% ifequal profile.user user %}You apparently haven't{% else %}This user hasn't{% endifequal %} spotted any animals yet. 
		{% ifequal profile.user user %}Spot now?{% endifequal %}		
	</p>
	{% endif %}
</div>

<div id="my_trips">
	<h2>{% ifequal profile.user user %}My{% else %}{{ profile.user|title }}'s{% endifequal %} Trips</h2>
	{% if profile.user.created_trip_set.all %}
	<ol>
	{% for trip in profile.user.created_trip_set.all %}
		<li>
			<p>During your trip to <a href="{{ trip.place.urls.absolute }}">{{ trip.place.known_as }}</a> on {{ trip.start|date:"jS F Y" }} you saw</p>
			<ul>
			{% for species in trip.sightings.all %}
				<li><a href="{{ species.urls.absolute }}">{{ species.common_name }}</a></li>
			{% endfor %}
			</ul>
		</li>
	{% endfor %}
	</ol>
	{% else %}
	<p>
		{% ifequal profile.user user %}You haven't{% else %}This user hasn't{% endifequal %} been anywhere yet. 
		{% ifequal profile.user user %}View recommendations from other users?{% else %}Recommend somewhere for this user to visit?{% endifequal %}		
	</p>
	{% endif %}
</div>

<div id="favourite_species">
	<h2>Favourite Animals</h2>
	{% if request.user.favourite_species.all %}
	<ol>
    {% for favourite in request.user.favourite_species.all %}
	<li><a href="{{ favourite.species.urls.absolute }}">{{ favourite.species }}</a>
		{% favourite_toggler "remove" favourite.species.slug request.path  %}
	</li>
	{% endfor %}
	</ol>
	{% else %}
	<p>
		{% ifequal profile.user user %}You don't{% else %}This user doesn't{% endifequal %} have any favourite animals yet. 
		{% ifequal profile.user user %}Pick some?{% else %}Suggest some?{% endifequal %}
	</p>
	{% endif %}
</div>


{% if user.comment_comments.all %}
<h2>{% ifequal profile.user user %}My{% else %}{{ profile.user|title }}'s{% endifequal %} Comments:</h2>
{% for comment in user.comment_comments.all %}
<div class="comment">
{{ comment.comment|linebreaks }}
<div class="posted-by">Posted on <a href="{{ comment.content_object.urls.absolute }}#c{{ comment.id }}">{{ comment.content_object }}</a> at {{ comment.submit_date|date:"jS F Y H:i" }}</div>
</div>
{% endfor %}
{% endif %}


{% endblock %}
